<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cat Survival: The Masterpiece</title>
    <style>
        :root { --gold: #FFD700; --cyan: #00F2FF; --bg: #050515; }
        body { margin: 0; background: var(--bg); overflow: hidden; font-family: 'Arial', sans-serif; touch-action: none; color: white; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ…Ø±ÙŠØ± Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø±Ø¶ÙŠØ© */
        .overlay { 
            position: fixed; inset: 0; 
            background: rgba(0,0,0,0.9); 
            z-index: 1000; 
            display: flex; flex-direction: column; align-items: center; 
            overflow-y: auto; padding: 20px;
        }

        .window { 
            background: linear-gradient(145deg, #0a0a25, #16163a); 
            padding: 25px; border-radius: 30px; 
            border: 2px solid var(--cyan); 
            width: 90%; max-width: 450px; 
            text-align: center; box-shadow: 0 0 50px rgba(0,242,255,0.3);
            margin-bottom: 20px;
        }

        .shop-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(85px, 1fr)); 
            gap: 12px; margin: 20px 0; 
            max-height: 200px; overflow-y: auto;
            background: rgba(0,0,0,0.4); padding: 10px; border-radius: 15px;
        }

        .card { 
            background: #1f1f50; padding: 10px; border-radius: 15px; 
            border: 2px solid #333; cursor: pointer; transition: 0.3s;
        }
        .card.active { border-color: var(--gold); transform: scale(1.05); background: #2a2a6a; }

        .start-btn { 
            background: #ffff00; color: black; padding: 20px 60px; 
            border-radius: 50px; border: none; font-size: 22px; 
            font-weight: bold; cursor: pointer; 
            box-shadow: 0 10px 20px rgba(255,255,0,0.4);
            z-index: 1001;
        }

        #distance-tag { 
            position: fixed; top: 30px; left: -40px; 
            background: var(--gold); color: black; 
            padding: 8px 50px; transform: rotate(-45deg); 
            font-weight: bold; z-index: 100;
        }

        canvas { display: block; }
    </style>
</head>
<body>

<div id="distance-tag">DISTANCE: <span id="dist-val">0</span>m</div>

<div id="main-overlay" class="overlay">
    <div class="window">
        <h1 style="color:var(--gold); margin:0;">ROYAL SHOP</h1>
        <p style="font-size:12px; color:#aaa;">Ø§Ø®ØªØ± Ù‚Ø·ØªÙƒ (20 Ù…Ø³ØªÙˆÙ‰) ÙˆØ³Ø§Ù‡Ù… ÙÙŠ Ø§Ù„Ø¥Ù†Ù‚Ø§Ø°</p>
        
        <div class="shop-grid" id="cat-shop">
            </div>

        <div style="background:rgba(46, 204, 113, 0.2); padding:15px; border-radius:20px; border:1px solid #2ecc71;">
            <p style="margin:0; font-size:13px;">ğŸ¥ ØªØ¨Ø±Ø¹ Ø¥Ù†Ø³Ø§Ù†ÙŠ Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù‚Ø·Ø· ($1)</p>
            <button onclick="alert('Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¨Ø±Ø¹Ùƒ!')" style="background:#2ecc71; border:none; color:white; padding:5px 15px; border-radius:10px; margin-top:10px; cursor:pointer;">ØªØ¨Ø±Ø¹ Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>
    <button class="start-btn" onclick="startGame()">START GAME / Ø§Ø¨Ø¯Ø£</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game'), ctx = canvas.getContext('2d');
let active = false, stage = 1, distance = 0, frame = 0;
let obstacles = [], coins = [];
// ØªÙ… Ø¶Ø¨Ø· Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© ÙˆØ§Ù„Ù‚ÙØ² Ù„ÙŠÙƒÙˆÙ† Ù…Ù…ØªØ¹Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹
let p = { x: 120, y: 0, v: 0, g: 0.5, j: -10, color: "#FFF", legPhase: 0 };

function resize() { 
    canvas.width = window.innerWidth; 
    canvas.height = window.innerHeight; 
}
window.onresize = resize; resize();

// Ø¥Ù†Ø´Ø§Ø¡ 20 Ù…ØªØ¬Ø±
const shop = document.getElementById('cat-shop');
for(let i=1; i<=20; i++) {
    const card = document.createElement('div');
    card.className = `card ${i===1?'active':''}`;
    card.onclick = () => {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        card.classList.add('active');
        p.color = `hsl(${(i*40)%360}, 70%, 70%)`; // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ù‚Ø·Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ØªØ¬Ø±
    };
    card.innerHTML = `<div style="font-size:25px">ğŸ±</div><div style="font-size:10px">LVL ${i}</div><div style="font-size:9px; color:var(--gold)">$0.99</div>`;
    shop.appendChild(card);
}

function startGame() {
    active = true;
    obstacles = []; distance = 0; frame = 0;
    p.y = canvas.height / 2;
    p.v = 0;
    document.getElementById('main-overlay').style.display = 'none';
    animate();
}

// Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ ÙˆØ§Ù„Ù…Ø§ÙˆØ³
function jump() { if(active) p.v = p.j; }
window.addEventListener('mousedown', jump);
window.addEventListener('touchstart', (e) => { jump(); e.preventDefault(); }, {passive: false});

function drawCat(x, y) {
    p.legPhase += 0.2;
    ctx.save(); ctx.translate(x, y);
    
    // Ø±Ø³Ù… 4 Ø£Ø±Ø¬Ù„ ØªØªØ­Ø±Ùƒ Ø­Ù‚ÙŠÙ‚Ø©
    ctx.strokeStyle = p.color; ctx.lineWidth = 3;
    for(let i=0; i<4; i++) {
        let legX = -15 + (i * 10);
        let legY = 15 + Math.sin(p.legPhase + i) * 10;
        ctx.beginPath(); ctx.moveTo(legX, 5); ctx.lineTo(legX, legY); ctx.stroke();
    }

    // Ø§Ù„Ø¬Ø³Ù…
    ctx.fillStyle = p.color; ctx.beginPath(); ctx.ellipse(0, 0, 25, 15, 0, 0, 7); ctx.fill();
    // Ø§Ù„Ø±Ø£Ø³
    ctx.beginPath(); ctx.arc(20, -10, 12, 0, 7); ctx.fill();
    // Ø¹ÙŠÙˆÙ†
    ctx.fillStyle = "black"; ctx.beginPath(); ctx.arc(24, -12, 2, 0, 7); ctx.fill();
    ctx.restore();
}

function animate() {
    if(!active) return;
    frame++; distance++;
    document.getElementById('dist-val').innerText = Math.floor(distance/10);

    // Ø®Ù„ÙÙŠØ©
    ctx.fillStyle = "#020210"; ctx.fillRect(0, 0, canvas.width, canvas.height);

    // ÙÙŠØ²ÙŠØ§Ø¡
    p.v += p.g;
    p.y += p.v;

    drawCat(p.x, p.y);

    // ÙˆØ­ÙˆØ´ (Ø¹ÙˆØ§Ø¦Ù‚)
    if(frame % 100 == 0) {
        obstacles.push({x: canvas.width, y: Math.random()*canvas.height, s: 40});
    }

    obstacles.forEach((o, i) => {
        o.x -= 7;
        // Ø±Ø³Ù… ÙˆØ­Ø´ Ù…Ø±Ø¹Ø¨ (Ø¹ÙŠÙ† Ø­Ù…Ø±Ø§Ø¡)
        ctx.fillStyle = "#ff4757";
        ctx.beginPath(); ctx.arc(o.x, o.y, 20, 0, 7); ctx.fill();
        ctx.fillStyle = "white"; ctx.beginPath(); ctx.arc(o.x+5, o.y-5, 5, 0, 7); ctx.fill();

        if(Math.hypot(p.x - o.x, p.y - o.y) < 35) endGame();
        if(o.x < -50) obstacles.splice(i, 1);
    });

    if(p.y > canvas.height || p.y < 0) endGame();

    requestAnimationFrame(animate);
}

function endGame() {
    active = false;
    document.getElementById('main-overlay').style.display = 'flex';
}
</script>
</body>
</html>