<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cat Survival: World Class</title>
    <style>
        :root { --gold: #FFD700; --cyan: #00F2FF; --accent: #ff0055; }
        body { margin: 0; background: #050510; overflow: hidden; font-family: 'Poppins', sans-serif; touch-action: none; color: white; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø§Ù„Ù…ÙŠØ© Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø²Ø¬Ø§Ø¬ Ø§Ù„Ø¶Ø¨Ø§Ø¨ÙŠ */
        .overlay { 
            position: fixed; inset: 0; 
            background: rgba(0, 0, 0, 0.85); 
            backdrop-filter: blur(15px);
            z-index: 1000; overflow-y: auto; 
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }

        .window { 
            background: rgba(255, 255, 255, 0.05); 
            padding: 30px; border-radius: 40px; 
            border: 1px solid rgba(255, 215, 0, 0.3); 
            width: 90%; max-width: 550px; 
            text-align: center; box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }

        h1.main-title { 
            font-size: 32px; margin-bottom: 5px; 
            background: linear-gradient(to right, var(--gold), #fff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }

        .shop-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); 
            gap: 15px; margin: 25px 0; max-height: 250px; overflow-y: auto;
            padding: 10px; border-radius: 20px; background: rgba(0,0,0,0.3);
        }

        .card { 
            background: rgba(255,255,255,0.08); padding: 15px; border-radius: 20px;
            border: 2px solid transparent; transition: 0.4s; cursor: pointer;
        }
        .card.active { border-color: var(--gold); background: rgba(255, 215, 0, 0.1); transform: scale(1.05); }

        .donate-btn {
            background: linear-gradient(45deg, #ff0055, #ff4757);
            border: none; padding: 12px 30px; border-radius: 15px;
            color: white; font-weight: bold; cursor: pointer; transition: 0.3s;
            box-shadow: 0 10px 20px rgba(255, 0, 85, 0.3);
        }

        .start-btn { 
            background: var(--gold); color: #000; padding: 18px 70px; 
            border-radius: 50px; border: none; font-size: 24px; 
            font-weight: 900; cursor: pointer; margin-top: 30px;
            transition: 0.3s; text-transform: uppercase;
        }

        #distance-tag { 
            position: fixed; top: 40px; left: -50px; 
            background: var(--gold); color: #000; 
            padding: 10px 60px; transform: rotate(-45deg); 
            font-weight: bold; z-index: 100; box-shadow: 0 5px 20px rgba(0,0,0,0.8);
        }

        canvas { display: block; }
    </style>
</head>
<body>

<div id="distance-tag">MILES: <span id="dist-val">0</span></div>

<div id="main-overlay" class="overlay">
    <div class="window">
        <h1 class="main-title">ROYAL CAT ADVENTURE</h1>
        <p style="color: #aaa; font-size: 14px;">Ù…Ù‡Ù…Ø© Ø¥Ù†Ù‚Ø§Ø° Ø¹Ø§Ù„Ù…ÙŠØ© - Ø§Ù„Ù…Ø±Ø­Ù„Ø© <span id="stage-val">1</span></p>

        <div class="shop-grid" id="cat-shop"></div>

        <div style="background: rgba(0,0,0,0.4); padding: 15px; border-radius: 20px; margin-bottom: 20px;">
            <p style="margin: 0 0 10px 0; font-size: 13px;">ğŸ¥ ØªØ¨Ø±Ø¹ Ø¥Ù†Ø³Ø§Ù†ÙŠ Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù‚Ø·Ø· ÙˆØ§Ù„Ù…Ø­ØªØ§Ø¬ÙŠÙ†</p>
            <button class="donate-btn" onclick="donate()">ØªØ¨Ø±Ø¹ Ø¨Ù‚ÙŠÙ…Ø© $1.00</button>
        </div>
    </div>
    <button class="start-btn" onclick="startGame()">START GAME</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game'), ctx = canvas.getContext('2d');
let active = false, stage = 1, distance = 0, frame = 0;
let obstacles = [], coins = [];
// ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡: ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© (g) ÙˆØ²ÙŠØ§Ø¯Ø© Ù‚ÙˆØ© Ø§Ù„Ù‚ÙØ²Ø© (j)
let p = { x: 150, y: 0, v: 0, g: 0.45, j: -8.5, color: "#FFD700", legPhase: 0 };

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.onresize = resize; resize();

// Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ
const shop = document.getElementById('cat-shop');
for(let i=1; i<=20; i++) {
    shop.innerHTML += `
        <div class="card ${i===1?'active':''}" onclick="selectLevel(${i})">
            <div style="font-size:30px">ğŸ±</div>
            <div style="font-size:11px; margin-top:5px;">LEVEL ${i}</div>
            <div style="font-size:10px; color:var(--gold)">$0.99</div>
        </div>`;
}

function startGame() {
    obstacles = []; coins = []; distance = 0;
    p.y = canvas.height / 2;
    p.v = 0; 
    document.getElementById('main-overlay').style.display = 'none';
    active = true; animate();
}

// Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ Ø£Ùˆ Ø§Ù„Ù…Ø§ÙˆØ³
const handleAction = (e) => { 
    if(active) { p.v = p.j; } 
    if(e.type === 'touchstart') e.preventDefault();
};
window.addEventListener('mousedown', handleAction);
window.addEventListener('touchstart', handleAction, {passive: false});

function drawCat(x, y) {
    p.legPhase += 0.15;
    ctx.save(); ctx.translate(x, y);
    
    // Ø§Ù„Ø£Ø±Ø¬Ù„ Ù…Ø¹ Ø­Ø±ÙƒØ© Ø§Ù†Ø³ÙŠØ§Ø¨ÙŠØ©
    ctx.strokeStyle = "#fff"; ctx.lineWidth = 3;
    for(let i=0; i<4; i++) {
        let legX = -15 + (i * 10);
        let legY = 15 + Math.sin(p.legPhase + i) * 10;
        ctx.beginPath(); ctx.moveTo(legX, 5); ctx.lineTo(legX, legY); ctx.stroke();
    }

    // Ø§Ù„Ø¬Ø³Ù… (Ù‚Ø·Ø© Ù…Ù„ÙƒÙŠØ©)
    ctx.fillStyle = p.color;
    ctx.beginPath(); ctx.ellipse(0, 0, 30, 18, 0, 0, Math.PI*2); ctx.fill();
    // Ø§Ù„Ø±Ø£Ø³
    ctx.beginPath(); ctx.arc(22, -10, 14, 0, Math.PI*2); ctx.fill();
    // Ø§Ù„Ø£Ø°Ù†ÙŠÙ†
    ctx.beginPath(); ctx.moveTo(15, -20); ctx.lineTo(22, -32); ctx.lineTo(29, -20); ctx.fill();
    // Ø¹ÙŠÙˆÙ† Ù…ØªÙˆÙ‡Ø¬Ø©
    ctx.fillStyle = "#000"; ctx.beginPath(); ctx.arc(26, -12, 3, 0, Math.PI*2); ctx.fill();
    ctx.fillStyle = varColor('--cyan'); ctx.beginPath(); ctx.arc(26, -12, 1.5, 0, Math.PI*2); ctx.fill();
    
    ctx.restore();
}

function varColor(name) { return getComputedStyle(document.documentElement).getPropertyValue(name); }

function animate() {
    if(!active) return;
    frame++; distance++;
    document.getElementById('dist-val').innerText = Math.floor(distance/10);

    // Ø®Ù„ÙÙŠØ© Ù…ØªØ¯Ø±Ø¬Ø© Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠØ©
    let grd = ctx.createLinearGradient(0, 0, 0, canvas.height);
    grd.addColorStop(0, "#050515");
    grd.addColorStop(1, `hsl(${(200 + stage*20)%360}, 50%, 15%)`);
    ctx.fillStyle = grd; ctx.fillRect(0, 0, canvas.width, canvas.height);

    // ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ø­Ø±ÙƒØ©
    p.v += p.g;
    p.y += p.v;

    drawCat(p.x, p.y);

    // ØªÙˆÙ„ÙŠØ¯ Ø¹ÙˆØ§Ø¦Ù‚ ÙˆØ­ÙˆØ´ Ù…Ø±Ø¹Ø¨Ø©
    if(frame % Math.max(40, 90 - stage*2) == 0) {
        obstacles.push({
            x: canvas.width, 
            y: Math.random() * canvas.height, 
            s: 40 + Math.random()*50,
            speed: 6 + (stage * 0.5)
        });
    }

    obstacles.forEach((o, i) => {
        o.x -= o.speed;
        // Ø±Ø³Ù… ÙˆØ­Ø´ "Ø§Ù„Ø¸Ù„"
        ctx.fillStyle = "rgba(255, 0, 85, 0.8)";
        ctx.shadowBlur = 15; ctx.shadowColor = "red";
        ctx.beginPath(); ctx.arc(o.x, o.y, o.s/2, 0, Math.PI*2); ctx.fill();
        ctx.shadowBlur = 0;

        // ØªØµØ§Ø¯Ù… Ø¯Ù‚ÙŠÙ‚
        if(Math.hypot(p.x - o.x, p.y - o.y) < (o.s/2 + 20)) endGame();
        if(o.x < -100) obstacles.splice(i, 1);
    });

    // Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ø§Ø´Ø©
    if(p.y > canvas.height || p.y < 0) endGame();

    requestAnimationFrame(animate);
}

function endGame() {
    active = false;
    document.getElementById('main-overlay').style.display = 'flex';
}

function donate() {
    alert("Ø³ÙŠØªÙ… ÙØªØ­ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¢Ù…Ù†Ø©.. Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø³Ø§Ù‡Ù…ØªÙƒ ÙÙŠ Ø¥Ù†Ù‚Ø§Ø° Ø§Ù„Ø£Ø±ÙˆØ§Ø­! â¤ï¸");
}
</script>
</body>
</html>