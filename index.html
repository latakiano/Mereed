<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cat Survival: The Global Mission</title>
    <style>
        :root { --gold: #FFD700; --cyan: #00F2FF; --red: #ff4757; }
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Segoe UI', sans-serif; touch-action: none; color: white; }
        
        /* Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„ØªÙ…Ø±ÙŠØ± */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000; overflow-y: auto; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .window { background: #0a0a25; padding: 25px; border-radius: 30px; border: 3px solid var(--cyan); width: 90%; max-width: 500px; box-shadow: 0 0 50px rgba(0,242,255,0.2); }
        
        #distance-tag { position: fixed; top: 30px; left: -40px; background: var(--gold); color: #000; padding: 10px 50px; transform: rotate(-45deg); font-weight: bold; z-index: 100; font-size: 14px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }

        .shop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; margin: 20px 0; max-height: 200px; overflow-y: auto; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 15px; }
        .card { background: #16163a; padding: 10px; border-radius: 15px; border: 2px solid #333; text-align: center; font-size: 10px; transition: 0.3s; cursor: pointer; }
        .card.active { border-color: var(--gold); transform: scale(1.05); }

        .leaderboard { margin: 15px 0; background: rgba(0,0,0,0.5); border-radius: 15px; padding: 10px; font-size: 12px; }
        .leader-item { display: flex; justify-content: space-between; border-bottom: 1px solid #222; padding: 5px 0; }

        .donate-section { background: linear-gradient(45deg, #1e3799, #0c2461); padding: 15px; border-radius: 20px; border: 1px solid var(--cyan); margin-top: 15px; text-align: center; }
        .start-btn { background: var(--gold); color: #000; padding: 15px 60px; border-radius: 50px; border: none; font-size: 22px; font-weight: bold; cursor: pointer; margin-top: 20px; box-shadow: 0 10px 30px rgba(255,215,0,0.4); }
    </style>
</head>
<body>

<div id="distance-tag">DISTANCE: <span id="dist-val">0</span>m</div>

<div id="main-overlay" class="overlay">
    <div class="window">
        <h2 style="color:var(--gold); margin:0;">ROYAL SHOP & CHARITY</h2>
        <p style="font-size:12px; color:#888;">Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ù…Ø±Ø­Ù„Ø© <span id="stage-val">1</span> - ÙƒÙ„ Ø¯ÙˆÙ„Ø§Ø± ÙŠÙ†Ù‚Ø° Ø­ÙŠØ§Ø©</p>

        <div class="shop-grid" id="cat-shop"></div>

        <div class="leaderboard">
            <strong>ğŸ† Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ:</strong>
            <div id="leader-list"></div>
        </div>

        <div class="donate-section">
            <div style="font-size:14px;">ğŸ¥ ØªØ¨Ø±Ø¹ Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ù…Ø±ÙŠØ¶Ø© ($1)</div>
            <button onclick="donate()" style="background:var(--red); border:none; color:white; padding:8px 20px; border-radius:10px; margin-top:10px; cursor:pointer; font-weight:bold;">ØªØ¨Ø±Ø¹ Ø§Ù„Ø¢Ù† â¤ï¸</button>
        </div>
    </div>
    <button class="start-btn" onclick="startGame()">Ø§Ù†Ø·Ù„Ù‚ Ù„Ù„Ø¥Ù†Ù‚Ø§Ø°!</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game'), ctx = canvas.getContext('2d');
let active = false, stage = 1, distance = 0, frame = 0;
let obstacles = [], coins = [], p = { x: 120, y: 0, v: 0, g: 0.5, j: -9, color: "#FFF", legPhase: 0 };
let leaders = [
    {n: "Leo_UK", s: 15400}, {n: "Sara_SY", s: 12100}, {n: "Dev_Jimmy", s: 9800}
];

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playSfx(f, t, d) {
    let o = audioCtx.createOscillator(), g = audioCtx.createGain();
    o.type = t; o.frequency.setValueAtTime(f, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime+d);
    o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+d);
}

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.onresize = resize; resize();

// Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„ØªØ±ØªÙŠØ¨
function updateUI() {
    const shop = document.getElementById('cat-shop');
    shop.innerHTML = "";
    for(let i=1; i<=20; i++) {
        shop.innerHTML += `<div class="card ${i===stage?'active':''}">ğŸ±<br>Ù‚Ø·Ø© ${i}<br><span style="color:var(--gold)">$0.99</span></div>`;
    }
    const list = document.getElementById('leader-list');
    list.innerHTML = "";
    leaders.sort((a,b)=>b.s-a.s).slice(0,3).forEach(l => {
        list.innerHTML += `<div class="leader-item"><span>${l.n}</span><span>${l.s}m</span></div>`;
    });
}
updateUI();

function startGame() {
    if(audioCtx.state === 'suspended') audioCtx.resume();
    obstacles = []; coins = []; distance = 0; p.y = canvas.height/2;
    document.getElementById('main-overlay').style.display = 'none';
    active = true; animate();
}

window.onmousedown = () => { if(active) { p.v = p.j; playSfx(300, 'sine', 0.2); } };

function drawCat(x, y) {
    p.legPhase += 0.2;
    ctx.save(); ctx.translate(x, y);
    // Ø£Ø±Ø¬Ù„ ØªØªØ­Ø±Ùƒ
    ctx.strokeStyle = p.color; ctx.lineWidth = 3;
    for(let i=0; i<4; i++) {
        let off = i * Math.PI/2;
        let ly = 15 + Math.sin(p.legPhase + off) * 8;
        ctx.beginPath(); ctx.moveTo(-15 + i*8, 5); ctx.lineTo(-15 + i*8, ly); ctx.stroke();
    }
    // Ø¬Ø³Ù… ÙˆØ±Ø£Ø³
    ctx.fillStyle = p.color; ctx.beginPath(); ctx.ellipse(0, 0, 25, 15, 0, 0, 7); ctx.fill();
    ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(20, -10, 12, 0, 7); ctx.fill();
    ctx.fillStyle = "black"; ctx.beginPath(); ctx.arc(25, -12, 2, 0, 7); ctx.fill();
    ctx.restore();
}

function drawMonster(o) {
    ctx.save(); ctx.translate(o.x, o.y);
    // Ø£Ø¬Ù†Ø­Ø© ØªØªØ­Ø±Ùƒ
    let wing = Math.sin(frame * 0.2) * 20;
    ctx.fillStyle = "#3d3d3d";
    ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(-30, wing); ctx.lineTo(-10, 0); ctx.fill();
    ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(30, wing); ctx.lineTo(10, 0); ctx.fill();
    // Ø¬Ø³Ù… Ù…Ø±Ø¹Ø¨
    ctx.fillStyle = "#1a1a1a"; ctx.beginPath(); ctx.arc(0, 0, 20, 0, 7); ctx.fill();
    ctx.fillStyle = "red"; ctx.beginPath(); ctx.arc(-8, -5, 3, 0, 7); ctx.arc(8, -5, 3, 0, 7); ctx.fill();
    ctx.restore();
}

function animate() {
    if(!active) return;
    frame++; distance++;
    document.getElementById('dist-val').innerText = distance;
    ctx.fillStyle = "#020210"; ctx.fillRect(0,0,canvas.width, canvas.height);

    p.v += p.g; p.y += p.v;
    drawCat(p.x, p.y);

    if(frame % 80 == 0) obstacles.push({x: canvas.width, y: Math.random()*canvas.height});
    
    obstacles.forEach((o, i) => {
        o.x -= (7 + stage);
        drawMonster(o);
        if(Math.hypot(p.x-o.x, p.y-o.y) < 35) endGame();
    });

    if(p.y > canvas.height || p.y < 0) endGame();
    requestAnimationFrame(animate);
}

function endGame() {
    active = false; playSfx(100, 'sawtooth', 0.4);
    leaders.push({n: "You", s: distance});
    updateUI();
    document.getElementById('main-overlay').style.display = 'flex';
}

function donate() { alert("Ø´ÙƒØ±Ø§Ù‹ Ù„Ù‚Ù„Ø¨Ùƒ Ø§Ù„Ø·ÙŠØ¨! ØªØ¨Ø±Ø¹Ùƒ Ø³ÙŠØµÙ„ Ù„Ù…Ù† ÙŠØ­ØªØ§Ø¬Ù‡."); }
</script>
</body>
</html>